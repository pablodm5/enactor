<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<core:process xmlns:core="http://www.enactor.com/core" xmlns:retail="http://www.enactor.com/retail" xmlns:ns4="http://www.enactor.com/crm" xmlns:hta="http://docs.oasis-open.org/ns/bpel4people/ws-humantask/api/200803" xmlns:ns6="http://www.apis-it.hr/fin/2012/types/f73" xmlns:ns7="http://www.w3.org/2000/09/xmldsig#" xmlns:ns8="http://www.enactor.com/retail/storedRetailTransaction/service" xmlns:ns9="http://www.fu.gov.si/" xmlns:ns10="http://www.enactor.com/addressLookup/service" xmlns:htd="http://docs.oasis-open.org/ns/bpel4people/ws-humantask/200803" xmlns:htt="http://docs.oasis-open.org/ns/bpel4people/ws-humantask/types/200803" xmlns:sref="http://docs.oasis-open.org/wsbpel/2.0/serviceref" xmlns:ns14="http://www.enactor.com/crm/customerLoyalty/service" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <core:processID>Pos/GiftCard/AuthServiceGiftCardCancel</core:processID>
    <core:version>1.0</core:version>
    <core:name></core:name>
    <core:defaultMessageBaseName></core:defaultMessageBaseName>
    <core:firstStateID>State</core:firstStateID>
    <core:className></core:className>
    <core:uiHints>
        <entry>
            <key>com.enactor.tools.editor.process.style</key>
            <value>2047</value>
        </entry>
        <entry>
            <key>com.enactor.tools.editor.process.xloc</key>
            <value>8</value>
        </entry>
        <entry>
            <key>com.enactor.tools.editor.process.yloc</key>
            <value>8</value>
        </entry>
    </core:uiHints>
    <core:metaData>
        <core:inputs>
            <core:input required="true" name="enactor.mfc.GiftCardType">
                <core:interfaceName>com.enactor.mfc.giftCardType.IGiftCardType</core:interfaceName>
            </core:input>
            <core:input required="true" name="enactor.mfc.BaseCurrency">
                <core:interfaceName>com.enactor.mfc.currency.ICurrency</core:interfaceName>
            </core:input>
            <core:input required="true" name="enactor.mfc.GiftCardTypeId">
                <core:interfaceName>java.lang.String</core:interfaceName>
            </core:input>
            <core:input required="true" name="enactor.pos.CardNumberScanned">
                <core:interfaceName>java.lang.String</core:interfaceName>
            </core:input>
            <core:input required="true" name="enactor.mfc.TransactionHandler">
                <core:interfaceName>com.enactor.mfc.retail.transaction.IRetailTransactionHandler</core:interfaceName>
            </core:input>
            <core:input required="true" name="enactor.pos.CardTrack2">
                <core:interfaceName>java.lang.String</core:interfaceName>
            </core:input>
            <core:input required="true" name="enactor.mfc.Location">
                <core:interfaceName>com.enactor.mfc.location.ILocation</core:interfaceName>
            </core:input>
            <core:input required="true" name="enactor.mfc.PosTerminal">
                <core:interfaceName>com.enactor.mfc.posTerminal.IPOSTerminal</core:interfaceName>
            </core:input>
            <core:input required="true" name="enactor.coreUI.User">
                <core:interfaceName>com.enactor.core.signOn.ISignedOnUser</core:interfaceName>
            </core:input>
            <core:input required="true" name="enactor.mfc.Reason">
                <core:interfaceName>com.enactor.mfc.reason.IReason</core:interfaceName>
            </core:input>
        </core:inputs>
        <stateDataTypes>
            <stateDataType required="true" name="enactor.cardAuthorisation.messages.GiftCardAuthorisationResponse">
                <core:interfaceName>com.enactor.cardAuthorisation.messages.giftCard.IGiftCardAuthorisationResponse</core:interfaceName>
            </stateDataType>
            <stateDataType required="true" name="enactor.pos.CardNumberScanned">
                <core:interfaceName>java.lang.String</core:interfaceName>
            </stateDataType>
            <stateDataType required="true" name="enactor.mfc.GiftCardDetails">
                <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardDetails</core:interfaceName>
            </stateDataType>
            <stateDataType required="true" name="enactor.mfc.GiftCardItem">
                <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardItem</core:interfaceName>
            </stateDataType>
            <stateDataType required="true" name="enactor.mfc.PosTerminal">
                <core:interfaceName>com.enactor.mfc.posTerminal.IPOSTerminal</core:interfaceName>
            </stateDataType>
            <stateDataType required="true" name="enactor.mfc.BaseCurrency">
                <core:interfaceName>com.enactor.mfc.currency.ICurrency</core:interfaceName>
            </stateDataType>
            <stateDataType required="true" name="enactor.mfc.Location">
                <core:interfaceName>com.enactor.mfc.location.ILocation</core:interfaceName>
            </stateDataType>
            <stateDataType required="true" name="enactor.mfc.Reason">
                <core:interfaceName>com.enactor.mfc.reason.IReason</core:interfaceName>
            </stateDataType>
            <stateDataType required="true" name="enactor.mfc.TransactionHandler">
                <core:interfaceName>com.enactor.mfc.retail.transaction.IRetailTransactionHandler</core:interfaceName>
            </stateDataType>
            <stateDataType required="true" name="enactor.pos.CardTrack2">
                <core:interfaceName>java.lang.String</core:interfaceName>
            </stateDataType>
            <stateDataType required="true" name="enactor.cardAuthorisation.messages.GiftCardAuthorisationRequest">
                <core:interfaceName>com.enactor.cardAuthorisation.messages.giftCard.IGiftCardAuthorisationRequest</core:interfaceName>
            </stateDataType>
            <stateDataType required="true" name="enactor.coreUI.User">
                <core:interfaceName>com.enactor.core.signOn.ISignedOnUser</core:interfaceName>
            </stateDataType>
            <stateDataType required="true" name="enactor.mfc.GiftCardType">
                <core:interfaceName>com.enactor.mfc.giftCardType.IGiftCardType</core:interfaceName>
            </stateDataType>
            <stateDataType required="true" name="enactor.mfc.GiftCardTypeId">
                <core:interfaceName>java.lang.String</core:interfaceName>
            </stateDataType>
            <stateDataType required="true" name="enactor.mfc.Acquirer">
                <core:interfaceName>com.enactor.mfc.acquirer.IAcquirer</core:interfaceName>
            </stateDataType>
        </stateDataTypes>
    </core:metaData>
    <core:endProcessAction>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:actionID>EndProcessFail</core:actionID>
        <core:name></core:name>
        <core:className>com.enactor.coreUI.actions.UIEndProcessAction</core:className>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>1</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>245</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>27</value>
            </entry>
        </core:uiHints>
        <core:metaData/>
        <core:typeId>enactor.types.EndProcess</core:typeId>
        <core:outcome>Fail</core:outcome>
        <core:defaultProcessId></core:defaultProcessId>
    </core:endProcessAction>
    <core:endProcessAction>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:actionID>EndProcessCancel</core:actionID>
        <core:name></core:name>
        <core:className>com.enactor.coreUI.actions.UIEndProcessAction</core:className>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>1</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>737</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>34</value>
            </entry>
        </core:uiHints>
        <core:metaData/>
        <core:typeId>enactor.types.EndProcess</core:typeId>
        <core:outcome>Cancel</core:outcome>
        <core:defaultProcessId></core:defaultProcessId>
    </core:endProcessAction>
    <core:endProcessAction>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:actionID>EndProcessSuccess</core:actionID>
        <core:name></core:name>
        <core:className>com.enactor.coreUI.actions.UIEndProcessAction</core:className>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>1</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>3753</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>43</value>
            </entry>
        </core:uiHints>
        <core:metaData/>
        <core:typeId>enactor.types.EndProcess</core:typeId>
        <core:outcome>Success</core:outcome>
        <core:defaultProcessId></core:defaultProcessId>
    </core:endProcessAction>
    <core:action>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:actionID>LoadAcquirer</core:actionID>
        <core:name></core:name>
        <core:className>com.enactor.commonUI.entities.processes.LoadEntityAction</core:className>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>127</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>1596</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>366</value>
            </entry>
        </core:uiHints>
        <core:metaData>
            <core:inputs>
                <core:input name="enactor.coreUI.Key">
                    <core:interfaceName>com.enactor.core.entities.IEntityKey</core:interfaceName>
                </core:input>
            </core:inputs>
            <core:outputs>
                <core:output name="enactor.coreUI.Entity">
                    <core:interfaceName>com.enactor.core.entities.IEntity</core:interfaceName>
                </core:output>
                <core:output name="enactor.coreUI.Key">
                    <core:interfaceName>com.enactor.core.entities.IEntityKey</core:interfaceName>
                </core:output>
            </core:outputs>
            <core:outcomes>
                <core:outcome name="Success"/>
            </core:outcomes>
            <core:sessionManagementType>NONE</core:sessionManagementType>
        </core:metaData>
        <core:typeId>enactor.types.BasicAction</core:typeId>
        <core:outcomeLink>
            <core:linkID>1</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>OverrideAcquirerCredentials</core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Success</core:outcome>
        </core:outcomeLink>
    </core:action>
    <core:executeProcessAction>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:actionID>AddToBasket</core:actionID>
        <core:name></core:name>
        <core:className>com.enactor.coreUI.actions.UICallProcessAction</core:className>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>63</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>3934</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>242</value>
            </entry>
        </core:uiHints>
        <core:param value="class://com.enactor.mfc.basket.processors.NonMerchandiseItemProcessor" name="enactor.mfc.TransactionItemProcessor">
            <core:interfaceName>com.enactor.core.transaction.ITransactionItemProcessor</core:interfaceName>
        </core:param>
        <core:metaData>
            <core:inputs>
                <core:input required="false" name="enactor.mfc.TransactionHandler">
                    <core:interfaceName>com.enactor.mfc.retail.transaction.IRetailTransactionHandler</core:interfaceName>
                </core:input>
                <core:input required="false" name="enactor.mfc.BasketItem">
                    <core:interfaceName>com.enactor.mfc.basket.items.IBasketItem</core:interfaceName>
                </core:input>
                <core:input required="false" name="enactor.mfc.TransactionItemProcessor">
                    <core:interfaceName>com.enactor.core.transaction.ITransactionItemProcessor</core:interfaceName>
                </core:input>
            </core:inputs>
            <core:outcomes>
                <core:outcome name="Fail"/>
                <core:outcome name="Success"/>
            </core:outcomes>
        </core:metaData>
        <core:typeId>enactor.types.CallProcess</core:typeId>
        <core:outcomeLink>
            <core:linkID>1</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>EndProcessFail</core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Fail</core:outcome>
        </core:outcomeLink>
        <core:outcomeLink>
            <core:linkID>3</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>EndProcessSuccess</core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Success</core:outcome>
        </core:outcomeLink>
        <core:executeProcessId>Pos/Basket/AddItemToBasket</core:executeProcessId>
    </core:executeProcessAction>
    <core:assignAction>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:actionID>InitialiseGiftCardDetails</core:actionID>
        <core:name></core:name>
        <core:className>com.enactor.coreUI.actions.UIAssignAction</core:className>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>127</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>1263</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>368</value>
            </entry>
        </core:uiHints>
        <core:metaData>
            <core:inputs>
                <core:input required="true" name="enactor.mfc.GiftCardDetails">
                    <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardDetails</core:interfaceName>
                </core:input>
                <core:input required="true" name="enactor.mfc.GiftCardType">
                    <core:interfaceName>com.enactor.mfc.giftCardType.IGiftCardType</core:interfaceName>
                </core:input>
            </core:inputs>
            <core:outputs>
                <core:output required="true" name="enactor.mfc.GiftCardDetails">
                    <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardDetails</core:interfaceName>
                </core:output>
            </core:outputs>
            <core:outcomes>
                <core:outcome name="Success"/>
            </core:outcomes>
            <core:sessionManagementType>NONE</core:sessionManagementType>
        </core:metaData>
        <core:comment>Sets properties on the gift card basket item.
TODO more to do here...</core:comment>
        <core:typeId>enactor.types.Assign</core:typeId>
        <core:outcomeLink>
            <core:linkID>1</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>InitialiseGiftCardItem</core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Success</core:outcome>
        </core:outcomeLink>
        <core:outcomeLink>
            <core:linkID>2</core:linkID>
            <core:toStateID>CancelNotAllowed</core:toStateID>
            <core:toActionID></core:toActionID>
            <core:condition>!process.giftCardType.allowReturn</core:condition>
            <core:outcome>Success</core:outcome>
        </core:outcomeLink>
        <core:dataAssignment toExpression="giftCardDetails.giftCardTypeId" fromExpression="giftCardType.giftCardTypeId"/>
        <core:dataAssignment toExpression="giftCardDetails.acquirerKey" fromExpression="giftCardType.acquirerKey"/>
        <core:dataAssignment toExpression="giftCardDetails.cancelledCard" fromExpression="true"/>
    </core:assignAction>
    <core:assignAction>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:actionID>InitialiseGiftCardItem</core:actionID>
        <core:name></core:name>
        <core:className>com.enactor.coreUI.actions.UIAssignAction</core:className>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>127</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>1269</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>632</value>
            </entry>
        </core:uiHints>
        <core:metaData>
            <core:inputs>
                <core:input required="true" name="enactor.coreUI.User">
                    <core:interfaceName>com.enactor.core.signOn.ISignedOnUser</core:interfaceName>
                </core:input>
                <core:input required="true" name="enactor.mfc.GiftCardItem">
                    <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardItem</core:interfaceName>
                </core:input>
                <core:input required="true" name="enactor.mfc.GiftCardType">
                    <core:interfaceName>com.enactor.mfc.giftCardType.IGiftCardType</core:interfaceName>
                </core:input>
                <core:input required="true" name="enactor.mfc.Location">
                    <core:interfaceName>com.enactor.mfc.location.ILocation</core:interfaceName>
                </core:input>
                <core:input required="true" name="enactor.mfc.PosTerminal">
                    <core:interfaceName>com.enactor.mfc.posTerminal.IPOSTerminal</core:interfaceName>
                </core:input>
                <core:input name="enactor.mfc.Reason">
                    <core:interfaceName>com.enactor.mfc.reason.IReason</core:interfaceName>
                </core:input>
            </core:inputs>
            <core:outputs>
                <core:output required="true" name="enactor.mfc.GiftCardItem">
                    <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardItem</core:interfaceName>
                </core:output>
            </core:outputs>
            <core:outcomes>
                <core:outcome name="Success"/>
            </core:outcomes>
            <core:sessionManagementType>NONE</core:sessionManagementType>
        </core:metaData>
        <core:comment>Sets properties on the gift card basket item.
TODO more to do here...</core:comment>
        <core:typeId>enactor.types.Assign</core:typeId>
        <core:outcomeLink>
            <core:linkID>1</core:linkID>
            <core:toStateID>LoadAcquirer</core:toStateID>
            <core:toActionID></core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Success</core:outcome>
        </core:outcomeLink>
        <core:dataAssignment toExpression="giftCardItem.description" fromExpression="giftCardType.description"/>
        <core:dataAssignment toExpression="giftCardItem.deviceId" fromExpression="posTerminal.deviceId"/>
        <core:dataAssignment toExpression="giftCardItem.userId" fromExpression="user.userId"/>
        <core:dataAssignment toExpression="giftCardItem.quantity" fromExpression="1.0"/>
        <core:dataAssignment toExpression="giftCardItem.dateTimeCreated" fromExpression="dates:getNow()"/>
        <core:dataAssignment toExpression="giftCardItem.reasonKey" fromExpression="!empty(reason) ? reason.key : null"/>
        <core:dataAssignment toExpression="giftCardItem.isReturn" fromExpression="true"/>
    </core:assignAction>
    <core:executeProcessAction>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:actionID>OnlineAuthorisation</core:actionID>
        <core:name></core:name>
        <core:className>com.enactor.coreUI.actions.UICallProcessAction</core:className>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>1023</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>2679</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>282</value>
            </entry>
        </core:uiHints>
        <core:param value="#{enumValue('com.enactor.cardAuthorisation.messages.AuthorisationActionType','UPDATE')}" name="enactor.cardAuthorisation.AuthorisationActionType">
            <core:interfaceName>com.enactor.cardAuthorisation.messages.AuthorisationActionType</core:interfaceName>
        </core:param>
        <core:metaData>
            <core:inputs>
                <core:input name="enactor.cardAuthorisation.AuthorisationActionType">
                    <core:interfaceName>com.enactor.cardAuthorisation.messages.AuthorisationActionType</core:interfaceName>
                </core:input>
                <core:input required="true" name="enactor.mfc.Acquirer">
                    <core:interfaceName>com.enactor.mfc.acquirer.IAcquirer</core:interfaceName>
                </core:input>
                <core:input required="true" name="enactor.mfc.BasketItem">
                    <core:interfaceName>com.enactor.mfc.basket.items.IBasketItem</core:interfaceName>
                </core:input>
                <core:input required="true" name="enactor.mfc.TransactionHandler">
                    <core:interfaceName>com.enactor.mfc.retail.transaction.IRetailTransactionHandler</core:interfaceName>
                </core:input>
                <core:input name="enactor.pos.CardAuthServersStatus">
                    <core:interfaceName>com.enactor.cardPayment.processes.card.CardAuthServersStatus</core:interfaceName>
                </core:input>
            </core:inputs>
            <core:outputs>
                <core:output name="enactor.mfc.BasketItem">
                    <core:interfaceName>com.enactor.mfc.basket.items.IBasketItem</core:interfaceName>
                </core:output>
                <core:output required="true" name="enactor.cardAuthorisation.messages.GiftCardAuthorisationRequest">
                    <core:interfaceName>com.enactor.cardAuthorisation.messages.giftCard.IGiftCardAuthorisationRequest</core:interfaceName>
                </core:output>
                <core:output required="true" name="enactor.cardAuthorisation.messages.GiftCardAuthorisationResponse">
                    <core:interfaceName>com.enactor.cardAuthorisation.messages.giftCard.IGiftCardAuthorisationResponse</core:interfaceName>
                </core:output>
            </core:outputs>
            <core:outcomes>
                <core:outcome name="ReferralRequested"/>
                <core:outcome name="Cancel"/>
                <core:outcome name="Fail"/>
                <core:outcome name="Declined"/>
                <core:outcome name="Success"/>
            </core:outcomes>
        </core:metaData>
        <core:comment>The value will be got from the authorisation response so this must succeed.</core:comment>
        <core:typeId>enactor.types.CallProcess</core:typeId>
        <core:outcomeLink>
            <core:linkID>1</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>SetValue</core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Success</core:outcome>
        </core:outcomeLink>
        <core:outcomeLink>
            <core:linkID>3</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>EndProcessCancel</core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Cancel</core:outcome>
        </core:outcomeLink>
        <core:outcomeLink>
            <core:linkID>2</core:linkID>
            <core:toStateID>AuthorisationError</core:toStateID>
            <core:toActionID></core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Fail</core:outcome>
        </core:outcomeLink>
        <core:outcomeLink>
            <core:linkID>4</core:linkID>
            <core:toStateID>NotAuthorised</core:toStateID>
            <core:toActionID></core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Declined</core:outcome>
        </core:outcomeLink>
        <core:outcomeLink>
            <core:linkID>5</core:linkID>
            <core:toStateID>NotAuthorised</core:toStateID>
            <core:toActionID></core:toActionID>
            <core:condition></core:condition>
            <core:outcome>ReferralRequested</core:outcome>
        </core:outcomeLink>
        <core:outcomeLink>
            <core:linkID>6</core:linkID>
            <core:toStateID>EnterBalance</core:toStateID>
            <core:toActionID></core:toActionID>
            <core:condition>process.giftCardType.allowReturnOffline</core:condition>
            <core:outcome>Fail</core:outcome>
        </core:outcomeLink>
        <core:executeProcessId>Pos/GiftCard/GiftCardAuthorisation</core:executeProcessId>
    </core:executeProcessAction>
    <core:assignAction>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:actionID>SetGiftCardDetails</core:actionID>
        <core:name></core:name>
        <core:className>com.enactor.coreUI.actions.UIAssignAction</core:className>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>1</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>912</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>508</value>
            </entry>
        </core:uiHints>
        <core:metaData>
            <core:inputs>
                <core:input required="true" name="enactor.mfc.GiftCardDetails">
                    <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardDetails</core:interfaceName>
                </core:input>
                <core:input required="true" name="enactor.mfc.GiftCardItem">
                    <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardItem</core:interfaceName>
                </core:input>
            </core:inputs>
            <core:outputs>
                <core:output required="true" name="enactor.mfc.GiftCardItem">
                    <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardItem</core:interfaceName>
                </core:output>
            </core:outputs>
            <core:outcomes>
                <core:outcome name="Success"/>
            </core:outcomes>
            <core:sessionManagementType>NONE</core:sessionManagementType>
        </core:metaData>
        <core:comment></core:comment>
        <core:typeId>enactor.types.Assign</core:typeId>
        <core:outcomeLink>
            <core:linkID>1</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>InitialiseGiftCardDetails</core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Success</core:outcome>
        </core:outcomeLink>
        <core:dataAssignment toExpression="giftCardItem.giftCardDetails" fromExpression="giftCardDetails"/>
    </core:assignAction>
    <core:executeProcessAction>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:actionID>GetGiftCardDetails</core:actionID>
        <core:name></core:name>
        <core:className>com.enactor.coreUI.actions.UICallProcessAction</core:className>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>1023</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>622</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>283</value>
            </entry>
        </core:uiHints>
        <core:param value="SWIPE_CANCELLED_CARD" name="enactor.coreUI.MessageId">
            <core:interfaceName>java.lang.String</core:interfaceName>
        </core:param>
        <core:metaData>
            <core:inputs>
                <core:input name="enactor.coreUI.User">
                    <core:interfaceName>com.enactor.core.signOn.ISignedOnUser</core:interfaceName>
                </core:input>
                <core:input name="enactor.mfc.GiftCardDetails">
                    <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardDetails</core:interfaceName>
                </core:input>
                <core:input name="enactor.mfc.GiftCardType">
                    <core:interfaceName>com.enactor.mfc.giftCardType.IGiftCardType</core:interfaceName>
                </core:input>
                <core:input name="enactor.mfc.GiftCardTypeId">
                    <core:interfaceName>java.lang.String</core:interfaceName>
                </core:input>
                <core:input name="enactor.mfc.Location">
                    <core:interfaceName>com.enactor.mfc.location.ILocation</core:interfaceName>
                </core:input>
                <core:input name="enactor.mfc.PosTerminal">
                    <core:interfaceName>com.enactor.mfc.posTerminal.IPOSTerminal</core:interfaceName>
                </core:input>
                <core:input required="true" name="enactor.mfc.TransactionHandler">
                    <core:interfaceName>com.enactor.mfc.retail.transaction.IRetailTransactionHandler</core:interfaceName>
                </core:input>
                <core:input name="enactor.pos.CardNumberScanned">
                    <core:interfaceName>java.lang.String</core:interfaceName>
                </core:input>
                <core:input name="enactor.pos.CardTrack2">
                    <core:interfaceName>java.lang.String</core:interfaceName>
                </core:input>
                <core:input name="enactor.coreUI.MessageBasename">
                    <core:interfaceName>java.lang.String</core:interfaceName>
                </core:input>
                <core:input name="enactor.coreUI.MessageId">
                    <core:interfaceName>java.lang.String</core:interfaceName>
                </core:input>
            </core:inputs>
            <core:outputs>
                <core:output required="true" name="enactor.mfc.GiftCardDetails">
                    <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardDetails</core:interfaceName>
                </core:output>
                <core:output required="true" name="enactor.mfc.GiftCardType">
                    <core:interfaceName>com.enactor.mfc.giftCardType.IGiftCardType</core:interfaceName>
                </core:output>
            </core:outputs>
            <core:outcomes>
                <core:outcome name="Cancel"/>
                <core:outcome name="Fail"/>
                <core:outcome name="Success"/>
            </core:outcomes>
        </core:metaData>
        <core:typeId>enactor.types.CallProcess</core:typeId>
        <core:outcomeLink>
            <core:linkID>1</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>SetGiftCardDetails</core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Success</core:outcome>
        </core:outcomeLink>
        <core:outcomeLink>
            <core:linkID>2</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>EndProcessCancel</core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Cancel</core:outcome>
        </core:outcomeLink>
        <core:outcomeLink>
            <core:linkID>3</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>EndProcessFail</core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Fail</core:outcome>
        </core:outcomeLink>
        <core:executeProcessId>Pos/GiftCard/GetGiftCardDetails</core:executeProcessId>
    </core:executeProcessAction>
    <core:executeProcessAction>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:actionID>CaptureReference</core:actionID>
        <core:name></core:name>
        <core:className>com.enactor.coreUI.actions.UICallProcessAction</core:className>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>11</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>2035</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>343</value>
            </entry>
        </core:uiHints>
        <core:param value="Pos/GiftCard/GiftCardMessages" name="CaptureReferencePromptMessageBase">
            <core:interfaceName>java.lang.String</core:interfaceName>
        </core:param>
        <core:metaData>
            <core:inputs>
                <core:input required="false" name="enactor.coreUI.User">
                    <core:interfaceName>com.enactor.core.signOn.ISignedOnUser</core:interfaceName>
                </core:input>
                <core:input name="enactor.mfc.BasketItem">
                    <core:interfaceName>com.enactor.mfc.basket.items.IBasketItem</core:interfaceName>
                </core:input>
                <core:input name="CaptureReferencePromptMessageBase">
                    <core:interfaceName>java.lang.String</core:interfaceName>
                </core:input>
            </core:inputs>
            <core:outcomes>
                <core:outcome name="Success"/>
                <core:outcome name="Fail"/>
                <core:outcome name="Cancel"/>
            </core:outcomes>
        </core:metaData>
        <core:typeId>enactor.types.CallProcess</core:typeId>
        <core:outcomeLink>
            <core:linkID>1</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>EndProcessCancel</core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Cancel</core:outcome>
        </core:outcomeLink>
        <core:outcomeLink>
            <core:linkID>2</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>EndProcessFail</core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Fail</core:outcome>
        </core:outcomeLink>
        <core:outcomeLink>
            <core:linkID>3</core:linkID>
            <core:toStateID>CaptureNameAndAddress</core:toStateID>
            <core:toActionID></core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Success</core:outcome>
        </core:outcomeLink>
        <core:executeProcessId>Pos/Reference/CaptureReference</core:executeProcessId>
    </core:executeProcessAction>
    <core:executeProcessAction>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:actionID>CaptureCustomerAddress</core:actionID>
        <core:name></core:name>
        <core:className>com.enactor.coreUI.actions.UICallProcessAction</core:className>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>127</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>2298</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>343</value>
            </entry>
        </core:uiHints>
        <core:metaData>
            <core:inputs>
                <core:input name="enactor.mfc.TransactionHandler">
                    <core:interfaceName>com.enactor.mfc.retail.transaction.IRetailTransactionHandler</core:interfaceName>
                </core:input>
                <core:input name="enactor.coreUI.User">
                    <core:interfaceName>com.enactor.core.signOn.ISignedOnUser</core:interfaceName>
                </core:input>
                <core:input name="enactor.coreUI.UserLocale">
                    <core:interfaceName>com.enactor.core.localisation.ILocale</core:interfaceName>
                </core:input>
            </core:inputs>
            <core:outcomes>
                <core:outcome name="Cancel"/>
                <core:outcome name="Fail"/>
                <core:outcome name="Success"/>
            </core:outcomes>
        </core:metaData>
        <core:typeId>enactor.types.CallProcess</core:typeId>
        <core:outcomeLink>
            <core:linkID>1</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>EndProcessCancel</core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Cancel</core:outcome>
        </core:outcomeLink>
        <core:outcomeLink>
            <core:linkID>2</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>EndProcessFail</core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Fail</core:outcome>
        </core:outcomeLink>
        <core:outcomeLink>
            <core:linkID>3</core:linkID>
            <core:toStateID>Authorise</core:toStateID>
            <core:toActionID></core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Success</core:outcome>
        </core:outcomeLink>
        <core:executeProcessId>Pos/Address/CaptureCustomerDetailsReason</core:executeProcessId>
    </core:executeProcessAction>
    <core:assignAction>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:actionID>SetValue</core:actionID>
        <core:name></core:name>
        <core:className>com.enactor.coreUI.actions.UIAssignAction</core:className>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>1</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>3002</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>526</value>
            </entry>
        </core:uiHints>
        <core:metaData>
            <core:inputs>
                <core:input required="true" name="enactor.cardAuthorisation.messages.GiftCardAuthorisationResponse">
                    <core:interfaceName>com.enactor.cardAuthorisation.messages.giftCard.IGiftCardAuthorisationResponse</core:interfaceName>
                </core:input>
                <core:input required="true" name="enactor.mfc.GiftCardItem">
                    <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardItem</core:interfaceName>
                </core:input>
            </core:inputs>
            <core:outputs>
                <core:output required="true" name="enactor.mfc.GiftCardItem">
                    <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardItem</core:interfaceName>
                </core:output>
            </core:outputs>
            <core:outcomes>
                <core:outcome name="Success"/>
            </core:outcomes>
            <core:sessionManagementType>NONE</core:sessionManagementType>
        </core:metaData>
        <core:comment>Set the value from the authorisation response.</core:comment>
        <core:typeId>enactor.types.Assign</core:typeId>
        <core:outcomeLink>
            <core:linkID>1</core:linkID>
            <core:toStateID>ConfirmCancelled</core:toStateID>
            <core:toActionID></core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Success</core:outcome>
        </core:outcomeLink>
        <core:dataAssignment toExpression="giftCardItem.unitPrice" fromExpression="-giftCardAuthorisationResponse.previousBalance"/>
        <core:dataAssignment toExpression="giftCardItem.value" fromExpression="-giftCardAuthorisationResponse.previousBalance"/>
    </core:assignAction>
    <core:action>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:actionID>ValidateAmount</core:actionID>
        <core:name></core:name>
        <core:className>com.enactor.coreUI.actions.UINullAction</core:className>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>1</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>3710</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>322</value>
            </entry>
        </core:uiHints>
        <core:metaData>
            <core:outcomes>
                <core:outcome name="Success"/>
            </core:outcomes>
            <core:sessionManagementType>NONE</core:sessionManagementType>
        </core:metaData>
        <core:typeId>enactor.types.BasicAction</core:typeId>
        <core:outcomeLink>
            <core:linkID>1</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>SetValueNegative</core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Success</core:outcome>
        </core:outcomeLink>
        <core:outcomeLink>
            <core:linkID>2</core:linkID>
            <core:toStateID>AmountTooLarge</core:toStateID>
            <core:toActionID></core:toActionID>
            <core:condition>process.giftCardType.maximumValue != 0 &amp;&amp; (process.giftCardItem.value) &gt; process.giftCardType.maximumValue</core:condition>
            <core:outcome>Success</core:outcome>
        </core:outcomeLink>
    </core:action>
    <core:assignAction>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:actionID>SetValueNegative</core:actionID>
        <core:name></core:name>
        <core:className>com.enactor.coreUI.actions.UIAssignAction</core:className>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>1</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>3710</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>448</value>
            </entry>
        </core:uiHints>
        <core:metaData>
            <core:inputs>
                <core:input required="true" name="enactor.mfc.GiftCardItem">
                    <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardItem</core:interfaceName>
                </core:input>
            </core:inputs>
            <core:outputs>
                <core:output required="true" name="enactor.mfc.GiftCardItem">
                    <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardItem</core:interfaceName>
                </core:output>
            </core:outputs>
            <core:outcomes>
                <core:outcome name="Success"/>
            </core:outcomes>
            <core:sessionManagementType>NONE</core:sessionManagementType>
        </core:metaData>
        <core:comment>Set the value negative for a return.</core:comment>
        <core:typeId>enactor.types.Assign</core:typeId>
        <core:outcomeLink>
            <core:linkID>1</core:linkID>
            <core:toStateID>AddToBasket</core:toStateID>
            <core:toActionID></core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Success</core:outcome>
        </core:outcomeLink>
        <core:dataAssignment toExpression="giftCardItem.unitPrice" fromExpression="-giftCardItem.value"/>
        <core:dataAssignment toExpression="giftCardItem.Value" fromExpression="-giftCardItem.value"/>
    </core:assignAction>
    <core:action>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:actionID>CreateGiftCardItem</core:actionID>
        <core:name></core:name>
        <core:className>com.enactor.coreUI.actions.CreateEntityAction</core:className>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>127</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>251</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>398</value>
            </entry>
        </core:uiHints>
        <core:param value="giftCardItem" name="enactor.coreUI.EntityName">
            <core:interfaceName>java.lang.String</core:interfaceName>
        </core:param>
        <core:param value="http://www.enactor.com/mfc" name="enactor.coreUI.EntityNamespace">
            <core:interfaceName>java.lang.String</core:interfaceName>
        </core:param>
        <core:metaData>
            <core:inputs>
                <core:input required="true" name="enactor.coreUI.EntityName">
                    <core:interfaceName>java.lang.String</core:interfaceName>
                </core:input>
                <core:input required="true" name="enactor.coreUI.EntityNamespace">
                    <core:interfaceName>java.lang.String</core:interfaceName>
                </core:input>
            </core:inputs>
            <core:outputs>
                <core:output name="enactor.coreUI.Entity">
                    <core:interfaceName>com.enactor.core.entities.IEntity</core:interfaceName>
                </core:output>
            </core:outputs>
            <core:outcomes>
                <core:outcome name="Success"/>
            </core:outcomes>
        </core:metaData>
        <core:outcomeLink>
            <core:linkID>1</core:linkID>
            <core:toStateID>GetGiftCardDetails</core:toStateID>
            <core:toActionID></core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Success</core:outcome>
        </core:outcomeLink>
    </core:action>
    <core:executeProcessAction>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:actionID>OverrideAcquirerCredentials</core:actionID>
        <core:name></core:name>
        <core:className>com.enactor.coreUI.actions.UICallProcessAction</core:className>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>2047</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>1822</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>455</value>
            </entry>
        </core:uiHints>
        <core:metaData>
            <core:inputs>
                <core:input required="true" name="enactor.mfc.Location">
                    <core:interfaceName>com.enactor.mfc.location.ILocation</core:interfaceName>
                </core:input>
                <core:input required="true" name="enactor.mfc.Acquirer">
                    <core:interfaceName>com.enactor.mfc.acquirer.IExternalAcquirer</core:interfaceName>
                </core:input>
            </core:inputs>
            <core:outputs>
                <core:output required="true" name="enactor.mfc.Acquirer">
                    <core:interfaceName>com.enactor.mfc.acquirer.IExternalAcquirer</core:interfaceName>
                </core:output>
            </core:outputs>
            <core:outcomes>
                <core:outcome name="Success"/>
            </core:outcomes>
        </core:metaData>
        <core:typeId>enactor.types.CallProcess</core:typeId>
        <core:outcomeLink>
            <core:linkID>1</core:linkID>
            <core:toStateID>CaptureReference</core:toStateID>
            <core:toActionID></core:toActionID>
            <core:condition></core:condition>
            <core:outcome>Success</core:outcome>
        </core:outcomeLink>
        <core:executeProcessId>Pos/GiftCard/GiftCardRetrieveAccountCredentials</core:executeProcessId>
    </core:executeProcessAction>
    <core:state>
        <core:url></core:url>
        <core:stateID>State</core:stateID>
        <core:name></core:name>
        <core:className></core:className>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>1</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>253</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>306</value>
            </entry>
        </core:uiHints>
        <core:metaData>
            <handledEvents>
                <handledEvent name="StateEntered"/>
            </handledEvents>
        </core:metaData>
        <core:typeId>enactor.types.BasicState</core:typeId>
        <core:singleInstance>false</core:singleInstance>
        <core:respondToViewEvents>false</core:respondToViewEvents>
        <core:actionInputMappings/>
        <core:actionOutputMappings>
            <core:actionMapping>
                <core:actionID>CreateGiftCardItem</core:actionID>
                <core:mappings>
                    <core:processMappings>
                        <core:mappings>
                            <core:sourceDataType name="enactor.coreUI.Entity">
<core:interfaceName>com.enactor.core.entities.IEntity</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType required="true" name="enactor.mfc.GiftCardItem">
<core:interfaceName>com.enactor.mfc.basket.items.IGiftCardItem</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                    </core:processMappings>
                    <core:stateMappings/>
                </core:mappings>
            </core:actionMapping>
        </core:actionOutputMappings>
        <core:eventLink>
            <core:linkID>1</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>CreateGiftCardItem</core:toActionID>
            <core:condition></core:condition>
            <core:event>StateEntered</core:event>
        </core:eventLink>
    </core:state>
    <core:state>
        <core:url></core:url>
        <core:stateID>LoadAcquirer</core:stateID>
        <core:name></core:name>
        <core:className></core:className>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>1</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>1498</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>706</value>
            </entry>
        </core:uiHints>
        <core:metaData>
            <handledEvents>
                <handledEvent name="StateEntered"/>
            </handledEvents>
            <stateDataTypes/>
        </core:metaData>
        <core:typeId>enactor.types.BasicState</core:typeId>
        <core:singleInstance>false</core:singleInstance>
        <core:respondToViewEvents>false</core:respondToViewEvents>
        <core:actionInputMappings>
            <core:actionMapping>
                <core:actionID>LoadAcquirer</core:actionID>
                <core:mappings>
                    <core:processMappings>
                        <core:mappings>
                            <core:sourceDataType name="enactor.mfc.GiftCardType">
<core:interfaceName>com.enactor.mfc.giftCardType.IGiftCardType</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType name="enactor.coreUI.Key">
<core:interfaceName>com.enactor.core.entities.IEntityKey</core:interfaceName>
                            </core:targetDataType>
                            <core:expression>giftCardType.acquirerKey</core:expression>
                        </core:mappings>
                    </core:processMappings>
                </core:mappings>
            </core:actionMapping>
        </core:actionInputMappings>
        <core:actionOutputMappings>
            <core:actionMapping>
                <core:actionID>LoadAcquirer</core:actionID>
                <core:mappings>
                    <core:processMappings>
                        <core:mappings>
                            <core:sourceDataType name="enactor.coreUI.Entity">
<core:interfaceName>com.enactor.core.entities.IEntity</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType required="true" name="enactor.mfc.Acquirer">
<core:interfaceName>com.enactor.mfc.acquirer.IExternalAcquirer</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                    </core:processMappings>
                </core:mappings>
            </core:actionMapping>
        </core:actionOutputMappings>
        <core:eventLink>
            <core:linkID>1</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>LoadAcquirer</core:toActionID>
            <core:condition></core:condition>
            <core:event>StateEntered</core:event>
        </core:eventLink>
        <core:eventLink>
            <core:linkID>2</core:linkID>
            <core:toStateID>CaptureReference</core:toStateID>
            <core:toActionID></core:toActionID>
            <core:condition>empty(process.giftCardType.acquirerKey)</core:condition>
            <core:event>StateEntered</core:event>
        </core:eventLink>
    </core:state>
    <core:state>
        <core:url></core:url>
        <core:stateID>Authorise</core:stateID>
        <core:name></core:name>
        <core:className></core:className>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>1</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>2679</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>704</value>
            </entry>
        </core:uiHints>
        <core:metaData>
            <handledEvents>
                <handledEvent name="StateEntered"/>
            </handledEvents>
        </core:metaData>
        <core:typeId>enactor.types.BasicState</core:typeId>
        <core:singleInstance>false</core:singleInstance>
        <core:respondToViewEvents>false</core:respondToViewEvents>
        <core:actionInputMappings>
            <core:actionMapping>
                <core:actionID>OnlineAuthorisation</core:actionID>
                <core:mappings>
                    <core:processMappings>
                        <core:mappings>
                            <core:sourceDataType required="true" name="enactor.mfc.TransactionHandler">
<core:interfaceName>com.enactor.mfc.retail.transaction.IRetailTransactionHandler</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType required="true" name="enactor.mfc.TransactionHandler">
<core:interfaceName>com.enactor.mfc.retail.transaction.IRetailTransactionHandler</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                        <core:mappings>
                            <core:sourceDataType required="true" name="enactor.mfc.GiftCardItem">
<core:interfaceName>com.enactor.mfc.basket.items.IGiftCardItem</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType required="true" name="enactor.mfc.BasketItem">
<core:interfaceName>com.enactor.mfc.basket.items.IBasketItem</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                        <core:mappings>
                            <core:sourceDataType required="true" name="enactor.mfc.Acquirer">
<core:interfaceName>com.enactor.mfc.acquirer.IExternalAcquirer</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType required="true" name="enactor.mfc.Acquirer">
<core:interfaceName>com.enactor.mfc.acquirer.IAcquirer</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                    </core:processMappings>
                    <core:stateMappings>
                        <core:mappings>
                            <core:targetDataType name="enactor.pos.CardAuthServersStatus">
<core:interfaceName>com.enactor.cardPayment.processes.card.CardAuthServersStatus</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                    </core:stateMappings>
                </core:mappings>
            </core:actionMapping>
        </core:actionInputMappings>
        <core:actionOutputMappings>
            <core:actionMapping>
                <core:actionID>OnlineAuthorisation</core:actionID>
                <core:mappings>
                    <core:processMappings>
                        <core:mappings>
                            <core:sourceDataType name="enactor.mfc.BasketItem">
<core:interfaceName>com.enactor.mfc.basket.items.IBasketItem</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType required="true" name="enactor.mfc.GiftCardItem">
<core:interfaceName>com.enactor.mfc.basket.items.IGiftCardItem</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                        <core:mappings>
                            <core:sourceDataType required="true" name="enactor.cardAuthorisation.messages.GiftCardAuthorisationRequest">
<core:interfaceName>com.enactor.cardAuthorisation.messages.giftCard.IGiftCardAuthorisationRequest</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType required="true" name="enactor.cardAuthorisation.messages.GiftCardAuthorisationRequest">
<core:interfaceName>com.enactor.cardAuthorisation.messages.giftCard.IGiftCardAuthorisationRequest</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                        <core:mappings>
                            <core:sourceDataType required="true" name="enactor.cardAuthorisation.messages.GiftCardAuthorisationResponse">
<core:interfaceName>com.enactor.cardAuthorisation.messages.giftCard.IGiftCardAuthorisationResponse</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType required="true" name="enactor.cardAuthorisation.messages.GiftCardAuthorisationResponse">
<core:interfaceName>com.enactor.cardAuthorisation.messages.giftCard.IGiftCardAuthorisationResponse</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                    </core:processMappings>
                    <core:stateMappings/>
                </core:mappings>
            </core:actionMapping>
        </core:actionOutputMappings>
        <core:eventLink>
            <core:linkID>1</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>OnlineAuthorisation</core:toActionID>
            <core:condition></core:condition>
            <core:event>StateEntered</core:event>
        </core:eventLink>
        <core:eventLink>
            <core:linkID>2</core:linkID>
            <core:toStateID>AddToBasket</core:toStateID>
            <core:toActionID></core:toActionID>
            <core:condition>empty(process.acquirer)</core:condition>
            <core:event>StateEntered</core:event>
        </core:eventLink>
    </core:state>
    <core:state>
        <core:url></core:url>
        <core:stateID>AddToBasket</core:stateID>
        <core:name></core:name>
        <core:className></core:className>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>1</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>3934</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>700</value>
            </entry>
        </core:uiHints>
        <core:metaData>
            <handledEvents>
                <handledEvent name="StateEntered"/>
            </handledEvents>
        </core:metaData>
        <core:typeId>enactor.types.BasicState</core:typeId>
        <core:singleInstance>false</core:singleInstance>
        <core:respondToViewEvents>false</core:respondToViewEvents>
        <core:actionInputMappings>
            <core:actionMapping>
                <core:actionID>AddToBasket</core:actionID>
                <core:mappings>
                    <core:processMappings>
                        <core:mappings>
                            <core:sourceDataType required="true" name="enactor.mfc.TransactionHandler">
<core:interfaceName>com.enactor.mfc.retail.transaction.IRetailTransactionHandler</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType required="false" name="enactor.mfc.TransactionHandler">
<core:interfaceName>com.enactor.mfc.retail.transaction.IRetailTransactionHandler</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                        <core:mappings>
                            <core:sourceDataType required="true" name="enactor.mfc.GiftCardItem">
<core:interfaceName>com.enactor.mfc.basket.items.IGiftCardItem</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType required="false" name="enactor.mfc.BasketItem">
<core:interfaceName>com.enactor.mfc.basket.items.IBasketItem</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                    </core:processMappings>
                </core:mappings>
            </core:actionMapping>
        </core:actionInputMappings>
        <core:actionOutputMappings/>
        <core:eventLink>
            <core:linkID>1</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>AddToBasket</core:toActionID>
            <core:condition></core:condition>
            <core:event>StateEntered</core:event>
        </core:eventLink>
    </core:state>
    <core:state>
        <core:url></core:url>
        <core:stateID>GetGiftCardDetails</core:stateID>
        <core:name></core:name>
        <core:className></core:className>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>1</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>628</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>758</value>
            </entry>
        </core:uiHints>
        <core:metaData>
            <handledEvents>
                <handledEvent name="StateEntered"/>
            </handledEvents>
        </core:metaData>
        <core:typeId>enactor.types.BasicState</core:typeId>
        <core:singleInstance>false</core:singleInstance>
        <core:respondToViewEvents>false</core:respondToViewEvents>
        <core:actionInputMappings>
            <core:actionMapping>
                <core:actionID>GetGiftCardDetails</core:actionID>
                <core:mappings>
                    <core:processMappings>
                        <core:mappings>
                            <core:sourceDataType name="enactor.mfc.GiftCardTypeId">
<core:interfaceName>java.lang.String</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType name="enactor.mfc.GiftCardTypeId">
<core:interfaceName>java.lang.String</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                        <core:mappings>
                            <core:sourceDataType required="true" name="enactor.mfc.GiftCardItem">
<core:interfaceName>com.enactor.mfc.basket.items.IGiftCardItem</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType name="enactor.mfc.GiftCardDetails">
<core:interfaceName>com.enactor.mfc.basket.items.IGiftCardDetails</core:interfaceName>
                            </core:targetDataType>
                            <core:expression>giftCardItem.giftCardDetails</core:expression>
                        </core:mappings>
                        <core:mappings>
                            <core:sourceDataType name="enactor.pos.CardTrack2">
<core:interfaceName>java.lang.String</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType name="enactor.pos.CardTrack2">
<core:interfaceName>java.lang.String</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                        <core:mappings>
                            <core:sourceDataType required="true" name="enactor.pos.CardNumberScanned">
<core:interfaceName>java.lang.String</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType name="enactor.pos.CardNumberScanned">
<core:interfaceName>java.lang.String</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                        <core:mappings>
                            <core:sourceDataType required="true" name="enactor.mfc.TransactionHandler">
<core:interfaceName>com.enactor.mfc.retail.transaction.IRetailTransactionHandler</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType required="true" name="enactor.mfc.TransactionHandler">
<core:interfaceName>com.enactor.mfc.retail.transaction.IRetailTransactionHandler</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                        <core:mappings>
                            <core:sourceDataType name="enactor.mfc.Location">
<core:interfaceName>com.enactor.mfc.location.ILocation</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType name="enactor.mfc.Location">
<core:interfaceName>com.enactor.mfc.location.ILocation</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                        <core:mappings>
                            <core:sourceDataType name="enactor.mfc.GiftCardType">
<core:interfaceName>com.enactor.mfc.giftCardType.IGiftCardType</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType name="enactor.mfc.GiftCardType">
<core:interfaceName>com.enactor.mfc.giftCardType.IGiftCardType</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                        <core:mappings>
                            <core:sourceDataType required="true" name="enactor.coreUI.User">
<core:interfaceName>com.enactor.core.signOn.ISignedOnUser</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType name="enactor.coreUI.User">
<core:interfaceName>com.enactor.core.signOn.ISignedOnUser</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                        <core:mappings>
                            <core:sourceDataType name="enactor.mfc.PosTerminal">
<core:interfaceName>com.enactor.mfc.posTerminal.IPOSTerminal</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType name="enactor.mfc.PosTerminal">
<core:interfaceName>com.enactor.mfc.posTerminal.IPOSTerminal</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                    </core:processMappings>
                    <core:stateMappings>
                        <core:mappings>
                            <core:targetDataType name="enactor.coreUI.MessageBasename">
<core:interfaceName>java.lang.String</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                    </core:stateMappings>
                </core:mappings>
            </core:actionMapping>
        </core:actionInputMappings>
        <core:actionOutputMappings/>
        <core:eventLink>
            <core:linkID>1</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>GetGiftCardDetails</core:toActionID>
            <core:condition></core:condition>
            <core:event>StateEntered</core:event>
        </core:eventLink>
    </core:state>
    <core:state>
        <core:url></core:url>
        <core:stateID>CaptureNameAndAddress</core:stateID>
        <core:name></core:name>
        <core:className></core:className>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>1</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>2298</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>704</value>
            </entry>
        </core:uiHints>
        <core:metaData>
            <core:inputs>
                <core:input name="enactor.mfc.CustomerPresentReason">
                    <core:interfaceName>com.enactor.mfc.reason.ICustomerPresentReason</core:interfaceName>
                </core:input>
            </core:inputs>
            <handledEvents>
                <handledEvent name="StateEntered"/>
            </handledEvents>
            <stateDataTypes>
                <stateDataType required="true" name="enactor.mfc.CustomerPresentReason">
                    <core:interfaceName>com.enactor.mfc.reason.ICustomerPresentReason</core:interfaceName>
                </stateDataType>
            </stateDataTypes>
        </core:metaData>
        <core:typeId>enactor.types.BasicState</core:typeId>
        <core:singleInstance>false</core:singleInstance>
        <core:respondToViewEvents>false</core:respondToViewEvents>
        <core:stateInputMappings>
            <core:mappings>
                <core:sourceDataType name="enactor.mfc.Reason">
                    <core:interfaceName>com.enactor.mfc.reason.IReason</core:interfaceName>
                </core:sourceDataType>
                <core:targetDataType name="enactor.mfc.CustomerPresentReason">
                    <core:interfaceName>com.enactor.mfc.reason.ICustomerPresentReason</core:interfaceName>
                </core:targetDataType>
            </core:mappings>
        </core:stateInputMappings>
        <core:actionInputMappings>
            <core:actionMapping>
                <core:actionID>CaptureCustomerAddress</core:actionID>
                <core:mappings>
                    <core:processMappings>
                        <core:mappings>
                            <core:sourceDataType required="true" name="enactor.coreUI.User">
<core:interfaceName>com.enactor.core.signOn.ISignedOnUser</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType name="enactor.coreUI.UserLocale">
<core:interfaceName>com.enactor.core.localisation.ILocale</core:interfaceName>
                            </core:targetDataType>
                            <core:expression>user.locale</core:expression>
                        </core:mappings>
                        <core:mappings>
                            <core:sourceDataType required="true" name="enactor.coreUI.User">
<core:interfaceName>com.enactor.core.signOn.ISignedOnUser</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType name="enactor.coreUI.User">
<core:interfaceName>com.enactor.core.signOn.ISignedOnUser</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                        <core:mappings>
                            <core:sourceDataType required="true" name="enactor.mfc.TransactionHandler">
<core:interfaceName>com.enactor.mfc.retail.transaction.IRetailTransactionHandler</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType name="enactor.mfc.TransactionHandler">
<core:interfaceName>com.enactor.mfc.retail.transaction.IRetailTransactionHandler</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                    </core:processMappings>
                    <core:stateMappings/>
                </core:mappings>
            </core:actionMapping>
        </core:actionInputMappings>
        <core:actionOutputMappings/>
        <core:eventLink>
            <core:linkID>1</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>CaptureCustomerAddress</core:toActionID>
            <core:condition>!empty(state.customerPresentReason) &amp;&amp; state.customerPresentReason.captureNameAndAddress</core:condition>
            <core:event>StateEntered</core:event>
        </core:eventLink>
        <core:eventLink>
            <core:linkID>2</core:linkID>
            <core:toStateID>Authorise</core:toStateID>
            <core:toActionID></core:toActionID>
            <core:condition></core:condition>
            <core:event>StateEntered</core:event>
        </core:eventLink>
    </core:state>
    <core:promptState>
        <core:url>Pos/GiftCard/AuthorisationDeclined</core:url>
        <core:stateID>NotAuthorised</core:stateID>
        <core:name></core:name>
        <core:className>com.enactor.coreUI.states.UIPromptState</core:className>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>1023</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>3002</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>177</value>
            </entry>
        </core:uiHints>
        <core:metaData>
            <core:inputs>
                <core:input name="enactor.pos.Outcome">
                    <core:interfaceName>java.lang.String</core:interfaceName>
                </core:input>
                <core:input name="enactor.cardAuthorisation.messages.GiftCardAuthorisationResponse">
                    <core:interfaceName>com.enactor.cardAuthorisation.messages.giftCard.IGiftCardAuthorisationResponse</core:interfaceName>
                </core:input>
            </core:inputs>
            <handledEvents>
                <handledEvent name="OKPressed"/>
            </handledEvents>
            <stateDataTypes>
                <stateDataType required="true" name="enactor.pos.Outcome">
                    <core:interfaceName>java.lang.String</core:interfaceName>
                </stateDataType>
                <stateDataType name="enactor.cardAuthorisation.messages.GiftCardAuthorisationResponse">
                    <core:interfaceName>com.enactor.cardAuthorisation.messages.giftCard.IGiftCardAuthorisationResponse</core:interfaceName>
                </stateDataType>
            </stateDataTypes>
        </core:metaData>
        <core:comment>Authorisation Declined. Outcome may give the reason.</core:comment>
        <core:typeId>enactor.types.PromptState</core:typeId>
        <core:singleInstance>false</core:singleInstance>
        <core:respondToViewEvents>false</core:respondToViewEvents>
        <core:stateInputMappings>
            <core:mappings>
                <core:sourceDataType required="true" name="enactor.cardAuthorisation.messages.GiftCardAuthorisationResponse">
                    <core:interfaceName>com.enactor.cardAuthorisation.messages.giftCard.IGiftCardAuthorisationResponse</core:interfaceName>
                </core:sourceDataType>
                <core:targetDataType name="enactor.pos.Outcome">
                    <core:interfaceName>java.lang.String</core:interfaceName>
                </core:targetDataType>
                <core:expression>giftCardAuthorisationResponse.outcome</core:expression>
            </core:mappings>
            <core:mappings>
                <core:sourceDataType required="true" name="enactor.cardAuthorisation.messages.GiftCardAuthorisationResponse">
                    <core:interfaceName>com.enactor.cardAuthorisation.messages.giftCard.IGiftCardAuthorisationResponse</core:interfaceName>
                </core:sourceDataType>
                <core:targetDataType name="enactor.cardAuthorisation.messages.GiftCardAuthorisationResponse">
                    <core:interfaceName>com.enactor.cardAuthorisation.messages.giftCard.IGiftCardAuthorisationResponse</core:interfaceName>
                </core:targetDataType>
            </core:mappings>
        </core:stateInputMappings>
        <core:actionInputMappings/>
        <core:actionOutputMappings/>
        <core:eventLink>
            <core:linkID>1</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>EndProcessCancel</core:toActionID>
            <core:condition></core:condition>
            <core:event>OKPressed</core:event>
        </core:eventLink>
        <core:keepPromptOpen>false</core:keepPromptOpen>
        <core:keepPreviousPromptOpen>false</core:keepPreviousPromptOpen>
        <core:promptTimeout>0</core:promptTimeout>
        <core:hideOpenPrompt>false</core:hideOpenPrompt>
        <core:allowDatabasePromptLookup>false</core:allowDatabasePromptLookup>
    </core:promptState>
    <core:messageState>
        <core:url>/Error/Error</core:url>
        <core:stateID>CancelNotAllowed</core:stateID>
        <core:name></core:name>
        <core:className>com.enactor.coreUI.states.UIMessageState</core:className>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>1</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>1088</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>265</value>
            </entry>
        </core:uiHints>
        <core:metaData>
            <core:inputs>
                <core:input required="true" name="enactor.mfc.GiftCardType">
                    <core:interfaceName>com.enactor.mfc.giftCardType.IGiftCardType</core:interfaceName>
                </core:input>
            </core:inputs>
            <handledEvents>
                <handledEvent name="OKPressed"/>
            </handledEvents>
            <stateDataTypes>
                <stateDataType required="true" name="enactor.mfc.GiftCardType">
                    <core:interfaceName>com.enactor.mfc.giftCardType.IGiftCardType</core:interfaceName>
                </stateDataType>
            </stateDataTypes>
        </core:metaData>
        <core:typeId>ErrorMessage</core:typeId>
        <core:singleInstance>false</core:singleInstance>
        <core:respondToViewEvents>false</core:respondToViewEvents>
        <core:actionInputMappings/>
        <core:actionOutputMappings/>
        <core:eventLink>
            <core:linkID>1</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>EndProcessCancel</core:toActionID>
            <core:condition></core:condition>
            <core:event>OKPressed</core:event>
        </core:eventLink>
        <core:keepPromptOpen>false</core:keepPromptOpen>
        <core:keepPreviousPromptOpen>false</core:keepPreviousPromptOpen>
        <core:promptTimeout>0</core:promptTimeout>
        <core:hideOpenPrompt>false</core:hideOpenPrompt>
        <core:allowDatabasePromptLookup>false</core:allowDatabasePromptLookup>
        <core:messageBase>Pos/GiftCard/GiftCardMessages</core:messageBase>
        <core:messageId>CANCEL_NOT_ALLOWED</core:messageId>
        <core:messageText></core:messageText>
    </core:messageState>
    <core:state>
        <core:url></core:url>
        <core:stateID>CaptureReference</core:stateID>
        <core:name></core:name>
        <core:className></core:className>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>1</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>2035</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>704</value>
            </entry>
        </core:uiHints>
        <core:metaData>
            <handledEvents>
                <handledEvent name="StateEntered"/>
            </handledEvents>
        </core:metaData>
        <core:typeId>enactor.types.BasicState</core:typeId>
        <core:singleInstance>false</core:singleInstance>
        <core:respondToViewEvents>false</core:respondToViewEvents>
        <core:actionInputMappings>
            <core:actionMapping>
                <core:actionID>CaptureReference</core:actionID>
                <core:mappings>
                    <core:processMappings>
                        <core:mappings>
                            <core:sourceDataType required="true" name="enactor.coreUI.User">
<core:interfaceName>com.enactor.core.signOn.ISignedOnUser</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType required="false" name="enactor.coreUI.User">
<core:interfaceName>com.enactor.core.signOn.ISignedOnUser</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                        <core:mappings>
                            <core:sourceDataType required="true" name="enactor.mfc.GiftCardItem">
<core:interfaceName>com.enactor.mfc.basket.items.IGiftCardItem</core:interfaceName>
                            </core:sourceDataType>
                            <core:targetDataType name="enactor.mfc.BasketItem">
<core:interfaceName>com.enactor.mfc.basket.items.IBasketItem</core:interfaceName>
                            </core:targetDataType>
                        </core:mappings>
                    </core:processMappings>
                    <core:stateMappings/>
                </core:mappings>
            </core:actionMapping>
        </core:actionInputMappings>
        <core:actionOutputMappings/>
        <core:eventLink>
            <core:linkID>2</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>CaptureReference</core:toActionID>
            <core:condition>!empty(process.reason) &amp;&amp; process.reason.referenceRequired</core:condition>
            <core:event>StateEntered</core:event>
        </core:eventLink>
        <core:eventLink>
            <core:linkID>1</core:linkID>
            <core:toStateID>CaptureNameAndAddress</core:toStateID>
            <core:toActionID></core:toActionID>
            <core:condition></core:condition>
            <core:event>StateEntered</core:event>
        </core:eventLink>
    </core:state>
    <core:messageState>
        <core:url></core:url>
        <core:stateID>AuthorisationError</core:stateID>
        <core:name></core:name>
        <core:className>com.enactor.coreUI.states.UIMessageState</core:className>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>1</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>2463</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>49</value>
            </entry>
        </core:uiHints>
        <core:metaData>
            <handledEvents>
                <handledEvent name="OKPressed"/>
                <handledEvent name="CancelPressed"/>
            </handledEvents>
        </core:metaData>
        <core:typeId>enactor.types.MessageState</core:typeId>
        <core:singleInstance>false</core:singleInstance>
        <core:respondToViewEvents>false</core:respondToViewEvents>
        <core:actionInputMappings/>
        <core:actionOutputMappings/>
        <core:eventLink>
            <core:linkID>1</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>EndProcessCancel</core:toActionID>
            <core:condition></core:condition>
            <core:event>CancelPressed</core:event>
        </core:eventLink>
        <core:eventLink>
            <core:linkID>2</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>EndProcessCancel</core:toActionID>
            <core:condition></core:condition>
            <core:event>OKPressed</core:event>
        </core:eventLink>
        <core:keepPromptOpen>false</core:keepPromptOpen>
        <core:keepPreviousPromptOpen>false</core:keepPreviousPromptOpen>
        <core:promptTimeout>0</core:promptTimeout>
        <core:hideOpenPrompt>false</core:hideOpenPrompt>
        <core:allowDatabasePromptLookup>false</core:allowDatabasePromptLookup>
        <core:messageBase>Pos/GiftCard/GiftCardMessages</core:messageBase>
        <core:messageId>AUTHORISATION_ERROR</core:messageId>
        <core:messageText></core:messageText>
    </core:messageState>
    <core:messageState>
        <core:url>/Error/Error</core:url>
        <core:stateID>AmountTooLarge</core:stateID>
        <core:name></core:name>
        <core:className>com.enactor.coreUI.states.UIMessageState</core:className>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>1</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>3487</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>238</value>
            </entry>
        </core:uiHints>
        <core:metaData>
            <core:inputs>
                <core:input required="true" name="enactor.mfc.GiftCardType">
                    <core:interfaceName>com.enactor.mfc.giftCardType.IGiftCardType</core:interfaceName>
                </core:input>
            </core:inputs>
            <handledEvents>
                <handledEvent name="OKPressed"/>
            </handledEvents>
            <stateDataTypes>
                <stateDataType required="true" name="enactor.mfc.GiftCardType">
                    <core:interfaceName>com.enactor.mfc.giftCardType.IGiftCardType</core:interfaceName>
                </stateDataType>
            </stateDataTypes>
        </core:metaData>
        <core:typeId>ErrorMessage</core:typeId>
        <core:singleInstance>false</core:singleInstance>
        <core:respondToViewEvents>false</core:respondToViewEvents>
        <core:actionInputMappings/>
        <core:actionOutputMappings/>
        <core:eventLink>
            <core:linkID>1</core:linkID>
            <core:toStateID>EnterBalance</core:toStateID>
            <core:toActionID></core:toActionID>
            <core:condition></core:condition>
            <core:event>OKPressed</core:event>
        </core:eventLink>
        <core:keepPromptOpen>false</core:keepPromptOpen>
        <core:keepPreviousPromptOpen>false</core:keepPreviousPromptOpen>
        <core:promptTimeout>0</core:promptTimeout>
        <core:hideOpenPrompt>false</core:hideOpenPrompt>
        <core:allowDatabasePromptLookup>false</core:allowDatabasePromptLookup>
        <core:messageBase>Pos/GiftCard/GiftCardMessages</core:messageBase>
        <core:messageId>AMOUNT_TOO_LARGE</core:messageId>
        <core:messageText></core:messageText>
    </core:messageState>
    <core:promptState>
        <core:url>Pos/GiftCard/EnterGiftCardCancelledAmount</core:url>
        <core:stateID>EnterBalance</core:stateID>
        <core:name></core:name>
        <core:className>com.enactor.coreUI.states.UIPromptState</core:className>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>127</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>3487</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>367</value>
            </entry>
        </core:uiHints>
        <core:metaData>
            <core:inputs>
                <core:input required="true" name="enactor.mfc.GiftCardDetails">
                    <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardDetails</core:interfaceName>
                </core:input>
                <core:input required="true" name="enactor.mfc.GiftCardItem">
                    <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardItem</core:interfaceName>
                </core:input>
                <core:input required="true" name="enactor.mfc.CurrencyId">
                    <core:interfaceName>java.lang.String</core:interfaceName>
                </core:input>
            </core:inputs>
            <handledEvents>
                <handledEvent name="OKPressed"/>
                <handledEvent name="CancelPressed"/>
            </handledEvents>
            <stateDataTypes>
                <stateDataType required="true" name="enactor.mfc.GiftCardDetails">
                    <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardDetails</core:interfaceName>
                </stateDataType>
                <stateDataType required="true" name="enactor.mfc.GiftCardItem">
                    <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardItem</core:interfaceName>
                </stateDataType>
                <stateDataType required="true" name="enactor.mfc.CurrencyId">
                    <core:interfaceName>java.lang.String</core:interfaceName>
                </stateDataType>
            </stateDataTypes>
        </core:metaData>
        <core:typeId>enactor.types.PromptState</core:typeId>
        <core:singleInstance>false</core:singleInstance>
        <core:respondToViewEvents>false</core:respondToViewEvents>
        <core:stateInputMappings>
            <core:mappings>
                <core:sourceDataType required="true" name="enactor.mfc.GiftCardItem">
                    <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardItem</core:interfaceName>
                </core:sourceDataType>
                <core:targetDataType required="true" name="enactor.mfc.GiftCardItem">
                    <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardItem</core:interfaceName>
                </core:targetDataType>
            </core:mappings>
            <core:mappings>
                <core:sourceDataType required="true" name="enactor.mfc.GiftCardDetails">
                    <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardDetails</core:interfaceName>
                </core:sourceDataType>
                <core:targetDataType required="true" name="enactor.mfc.GiftCardDetails">
                    <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardDetails</core:interfaceName>
                </core:targetDataType>
            </core:mappings>
            <core:mappings>
                <core:sourceDataType name="enactor.mfc.GiftCardType">
                    <core:interfaceName>com.enactor.mfc.giftCardType.IGiftCardType</core:interfaceName>
                </core:sourceDataType>
                <core:targetDataType required="true" name="enactor.mfc.CurrencyId">
                    <core:interfaceName>java.lang.String</core:interfaceName>
                </core:targetDataType>
                <core:expression>notEmpty(giftCardType.currencyId) ? giftCardType.currencyId : baseCurrency.currencyId</core:expression>
            </core:mappings>
        </core:stateInputMappings>
        <core:actionInputMappings/>
        <core:actionOutputMappings/>
        <core:eventLink>
            <core:linkID>1</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>ValidateAmount</core:toActionID>
            <core:condition></core:condition>
            <core:event>OKPressed</core:event>
        </core:eventLink>
        <core:eventLink>
            <core:linkID>2</core:linkID>
            <core:toStateID></core:toStateID>
            <core:toActionID>EndProcessCancel</core:toActionID>
            <core:condition></core:condition>
            <core:event>CancelPressed</core:event>
        </core:eventLink>
        <core:keepPromptOpen>false</core:keepPromptOpen>
        <core:keepPreviousPromptOpen>false</core:keepPreviousPromptOpen>
        <core:promptTimeout>0</core:promptTimeout>
        <core:hideOpenPrompt>false</core:hideOpenPrompt>
        <core:allowDatabasePromptLookup>false</core:allowDatabasePromptLookup>
    </core:promptState>
    <core:messageState>
        <core:url>/Message/ModalOK</core:url>
        <core:stateID>ConfirmCancelled</core:stateID>
        <core:name></core:name>
        <core:className>com.enactor.coreUI.states.UIMessageState</core:className>
        <core:defaultNextStateID></core:defaultNextStateID>
        <core:uiHints>
            <entry>
                <key>com.enactor.tools.editor.process.style</key>
                <value>1023</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.xloc</key>
                <value>3226</value>
            </entry>
            <entry>
                <key>com.enactor.tools.editor.process.yloc</key>
                <value>526</value>
            </entry>
        </core:uiHints>
        <core:metaData>
            <core:inputs>
                <core:input required="true" name="enactor.mfc.GiftCardItem">
                    <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardItem</core:interfaceName>
                </core:input>
                <core:input required="true" name="enactor.mfc.GiftCardType">
                    <core:interfaceName>com.enactor.mfc.giftCardType.IGiftCardType</core:interfaceName>
                </core:input>
                <core:input required="true" name="enactor.cardAuthorisation.messages.GiftCardAuthorisationResponse">
                    <core:interfaceName>com.enactor.cardAuthorisation.messages.giftCard.IGiftCardAuthorisationResponse</core:interfaceName>
                </core:input>
            </core:inputs>
            <handledEvents>
                <handledEvent name="OKPressed"/>
                <handledEvent name="CancelPressed"/>
            </handledEvents>
            <stateDataTypes>
                <stateDataType required="true" name="enactor.mfc.GiftCardType">
                    <core:interfaceName>com.enactor.mfc.giftCardType.IGiftCardType</core:interfaceName>
                </stateDataType>
                <stateDataType required="true" name="enactor.mfc.GiftCardItem">
                    <core:interfaceName>com.enactor.mfc.basket.items.IGiftCardItem</core:interfaceName>
                </stateDataType>
                <stateDataType required="true" name="enactor.cardAuthorisation.messages.GiftCardAuthorisationResponse">
                    <core:interfaceName>com.enactor.cardAuthorisation.messages.giftCard.IGiftCardAuthorisationResponse</core:interfaceName>
                </stateDataType>
            </stateDataTypes>
        </core:metaData>
        <core:typeId>ErrorMessage</core:typeId>
        <core:singleInstance>false</core:singleInstance>
        <core:respondToViewEvents>false</core:respondToViewEvents>
        <core:actionInputMappings/>
        <core:actionOutputMappings/>
        <core:eventLink>
            <core:linkID>1</core:linkID>
            <core:toStateID>AddToBasket</core:toStateID>
            <core:toActionID></core:toActionID>
            <core:condition></core:condition>
            <core:event>OKPressed</core:event>
        </core:eventLink>
        <core:eventLink>
            <core:linkID>2</core:linkID>
            <core:toStateID>AddToBasket</core:toStateID>
            <core:toActionID></core:toActionID>
            <core:condition></core:condition>
            <core:event>CancelPressed</core:event>
        </core:eventLink>
        <core:keepPromptOpen>false</core:keepPromptOpen>
        <core:keepPreviousPromptOpen>false</core:keepPreviousPromptOpen>
        <core:promptTimeout>0</core:promptTimeout>
        <core:hideOpenPrompt>false</core:hideOpenPrompt>
        <core:allowDatabasePromptLookup>false</core:allowDatabasePromptLookup>
        <core:messageBase>Pos/GiftCard/GiftCardMessages</core:messageBase>
        <core:messageId>CONFIRM_GIFT_CARD_CANCELLED_AMOUNT</core:messageId>
        <core:messageText></core:messageText>
    </core:messageState>
    <core:stateTransitions/>
</core:process>
